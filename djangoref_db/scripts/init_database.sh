#!/bin/bash

APP_DATABASE_NAME=${SQL_DATABASE}
DATABASE_USER=${SQL_USER}
DATABASE_USER_PASSWORD=${SQL_PASSWORD}
DB_DUMP_LOCATION='/tmp/psql_data/alibey_schema.sql'
DB_INIT_DATA_LOCATION='/tmp/psql_data/alibey_init_data.sql'

psql postgres -c "CREATE ROLE $DATABASE_USER LOGIN PASSWORD '$DATABASE_USER_PASSWORD' SUPERUSER INHERIT CREATEDB NOCREATEROLE NOREPLICATION;"
createdb $APP_DATABASE_NAME -O $DATABASE_USER

psql -d $APP_DATABASE_NAME -f "$DB_DUMP_LOCATION"
psql -d $APP_DATABASE_NAME -f "$DB_INIT_DATA_LOCATION"
